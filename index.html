<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Item Generator: 99 Nights in the Forest</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* Fallback */
            background: linear-gradient(145deg, #1e293b, #0f172a, #1e293b);
            background-size: 400% 400%;
            animation: shimmer 15s linear infinite;
        }
        .game-font {
            font-family: 'Press Start 2P', cursive;
        }
        .item-card.selected {
            border-color: #3b82f6; /* blue-500 */
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
        }
        .glowing-border {
            animation: glow 3s linear infinite;
        }
        .loader {
            border: 4px solid #f3f3f3; /* Light grey */
            border-top: 4px solid #3b82f6; /* Blue */
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes shimmer {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        @keyframes glow {
            0% { box-shadow: 0 0 5px rgba(59, 130, 246, 0.2); }
            50% { box-shadow: 0 0 20px rgba(59, 130, 246, 0.6); }
            100% { box-shadow: 0 0 5px rgba(59, 130, 246, 0.2); }
        }
        .item-card img {
            image-rendering: pixelated;
        }
    </style>
</head>
<body class="text-slate-200 flex items-center justify-center min-h-screen p-4 relative">

    <canvas id="confetti-canvas" class="absolute top-0 left-0 w-full h-full pointer-events-none" style="z-index: 55;"></canvas>

    <div id="app-container" class="w-full max-w-4xl mx-auto">

        <!-- Step 1: Item Selection -->
        <div id="step1" class="space-y-6">
            <header class="text-center">
                <img src="https://files.vgtimes.ru/posts/2025-09/vse-dostupnye-klassy-v-99-nights-in-the-forest-132675.webp" alt="99 Nights in the Forest Banner" class="mx-auto mb-6 rounded-lg shadow-lg w-full max-w-2xl">
                <h1 class="game-font text-2xl md:text-4xl font-bold text-white leading-tight">Item Generator</h1>
                <p class="game-font text-slate-400 mt-4 text-xs">99 Nights in the Forest</p>
            </header>

            <main>
                <p id="selection-counter" class="text-center text-lg mb-4 text-slate-300">Select 3 top items</p>
                <div id="item-grid" class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-4">
                    <!-- Item cards will be added here via JS -->
                </div>
            </main>

            <footer class="text-center">
                <button id="next-to-step2" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition-all duration-300 disabled:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed w-full sm:w-auto" disabled>
                    Next
                </button>
            </footer>
        </div>

        <!-- Step 2: Nickname Input -->
        <div id="step2" class="hidden text-center space-y-6 bg-slate-800 p-8 rounded-lg shadow-2xl max-w-md mx-auto glowing-border">
            <h2 class="text-2xl font-bold text-white">Enter your nickname</h2>
            <p class="text-slate-400">To add items to your account.</p>
            <input type="text" id="nickname-input" placeholder="Your game nickname" class="w-full bg-slate-700 border border-slate-600 text-white rounded-lg p-3 text-center focus:outline-none focus:ring-2 focus:ring-blue-500">
            <button id="next-to-step3" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition-all duration-300 disabled:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed w-full" disabled>
                Next
            </button>
        </div>

        <!-- Step 3: Loading -->
        <div id="step3" class="hidden text-center space-y-6 bg-slate-800 p-8 rounded-lg shadow-2xl max-w-md mx-auto">
            <div class="loader mx-auto"></div>
            <h2 class="text-2xl font-bold text-white">Loading...</h2>
            <p id="loading-text" class="text-slate-400">Adding items to your account.</p>
        </div>

        <!-- Step 4: Success -->
        <div id="step4" class="hidden text-center space-y-6 bg-slate-800 p-8 rounded-lg shadow-2xl max-w-md mx-auto" style="position: relative; z-index: 60;">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-green-400 mx-auto" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
            <h2 id="success-title" class="text-2xl font-bold text-white"></h2>
            <p class="text-slate-300">All selected items have been successfully added. Enjoy the game!</p>
            <button id="ok-button" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-lg transition-all duration-300 w-full">
                OK
            </button>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const items = [
                [
    { name: 'Old Sack', image: 'Old_sack.webp' },
    { name: 'Strong Rod', image: 'StrongRodTier3.webp' },
    { name: 'Admin Axe', image: 'Adminaxe.webp' },
    { name: 'Old Flute', image: 'OldFlute.webp' },
    { name: 'Old Axe', image: 'Old_axe.webp' },
    { name: 'Giant Sack', image: 'Giant_sack.webp' },
    { name: 'Necromancer', image: 'Necromancerclass.webp' },
    { name: 'Big Game Hunter', image: 'BigGameMasterclass.webp' },
    { name: 'Pyromaniac', image: 'Pyromancerclass.webp' },
    { name: 'Carrot', image: 'Carrot.webp' },
    { name: 'Leather Armor', image: 'Leatherarmor.webp' },
    { name: 'Obsidiron Chest', image: 'Obsidiron_Chest.webp' },
    { name: 'Log', image: 'Logcrop.webp' },
    { name: 'Wood Wall', image: 'Wood_wall.webp' },
    { name: 'Gold Shard', image: 'Gold_Shard.webp' },
    { name: 'Earmuff', image: 'Earmuff.webp' },
    { name: 'Oil Barrel', image: 'Oil_barrel.webp' },
    { name: 'Bolt', image: 'Bolt.webp' },
    { name: 'Party Hat', image: 'PartyHat.webp' },
    { name: 'Old Rod Tier 1', image: 'OldRodTier1.webp' },
    { name: 'Meteor Anvil', image: 'MeteorAnvilFront.webp' },
    { name: 'Cooked Lionfish', image: 'CookedLionfish.webp' },
    { name: 'Infinite Diamonds', image: 'https://i.ibb.co/bMKbFt4N/Diamond-Icon.png' }
]

            const itemGrid = document.getElementById('item-grid');
            const selectionCounter = document.getElementById('selection-counter');
            const nextToStep2Btn = document.getElementById('next-to-step2');
            const nicknameInput = document.getElementById('nickname-input');
            const nextToStep3Btn = document.getElementById('next-to-step3');
            const okButton = document.getElementById('ok-button');
            const successTitle = document.getElementById('success-title');
            const confettiCanvas = document.getElementById('confetti-canvas');

            const step1 = document.getElementById('step1');
            const step2 = document.getElementById('step2');
            const step3 = document.getElementById('step3');
            const step4 = document.getElementById('step4');

            let selectedItems = [];

            const myConfetti = confetti.create(confettiCanvas, {
                resize: true,
                useWorker: true
            });

            // Initialize item cards
            function initItems() {
                itemGrid.innerHTML = '';
                items.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'item-card bg-slate-800 p-3 rounded-lg text-center cursor-pointer border-2 border-transparent transition-all duration-300 hover:bg-slate-700 flex flex-col justify-between';
                    card.dataset.itemName = item.name;
                    card.innerHTML = `
                        <div class="flex-grow flex items-center justify-center">
                           <img src="${item.image}" alt="${item.name}" class="max-h-24 w-auto rounded-md mx-auto object-contain bg-slate-700/50" onerror="this.onerror=null;this.src='https://placehold.co/100x100/1e293b/94a3b8?text=Error';">
                        </div>
                        <p class="mt-2 text-xs font-medium text-slate-300 break-words">${item.name}</p>
                    `;
                    card.addEventListener('click', () => toggleItemSelection(card, item.name));
                    itemGrid.appendChild(card);
                });
            }

            // Item selection logic
            function toggleItemSelection(card, itemName) {
                const index = selectedItems.indexOf(itemName);
                if (index > -1) {
                    selectedItems.splice(index, 1);
                    card.classList.remove('selected');
                } else {
                    if (selectedItems.length < 3) {
                        selectedItems.push(itemName);
                        card.classList.add('selected');
                    }
                }
                updateSelectionUI();
            }

            // Update selection UI
            function updateSelectionUI() {
                const remaining = 3 - selectedItems.length;
                if (remaining === 0) {
                    selectionCounter.textContent = 'You have selected 3 items!';
                    nextToStep2Btn.disabled = false;
                } else {
                    selectionCounter.textContent = `Items left to select: ${remaining}`;
                    nextToStep2Btn.disabled = true;
                }
            }

            // Check nickname input
            nicknameInput.addEventListener('input', () => {
                nextToStep3Btn.disabled = nicknameInput.value.trim() === '';
            });

            // Go to step 2
            nextToStep2Btn.addEventListener('click', () => {
                step1.classList.add('hidden');
                step2.classList.remove('hidden');
            });

            // Go to step 3 (loading)
            nextToStep3Btn.addEventListener('click', () => {
                step2.classList.add('hidden');
                step3.classList.remove('hidden');
                
                setTimeout(() => {
                    goToStep4();
                }, 3000); // Simulate loading for 3 seconds
            });
            
            // Go to step 4 (success)
            function goToStep4() {
                const nickname = nicknameInput.value.trim();
                successTitle.textContent = `Congratulations, ${nickname}!`;
                step3.classList.add('hidden');
                step4.classList.remove('hidden');
                launchFireworks();
            }

            // "OK" button (reset)
            okButton.addEventListener('click', () => {
                myConfetti.reset();
                resetApp();
            });
            
            // Launch fireworks
            function launchFireworks() {
                const duration = 4 * 1000;
                const animationEnd = Date.now() + duration;

                const interval = setInterval(function() {
                    const timeLeft = animationEnd - Date.now();

                    if (timeLeft <= 0) {
                        return clearInterval(interval);
                    }

                    const particleCount = 50 * (timeLeft / duration);
                    // Launch fireworks from random positions at the bottom
                    myConfetti({
                        startVelocity: 30,
                        spread: 360,
                        ticks: 60,
                        zIndex: 55,
                        particleCount,
                        origin: { x: Math.random(), y: Math.random() - 0.2 },
                        colors: ['#FFD700', '#FFA500', '#FFC000', '#FFFFFF']
                    });
                }, 250);
            }

            // Reset state function
            function resetApp() {
                selectedItems = [];
                nicknameInput.value = '';
                
                step4.classList.add('hidden');
                step1.classList.remove('hidden');
                
                initItems();
                updateSelectionUI();
                nextToStep3Btn.disabled = true;
            }

            // Initial launch
            initItems();
        });
    </script>
</body>
</html>

